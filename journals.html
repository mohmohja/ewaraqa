<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>eWaraqa</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f7f7f7;
            margin: 0;
            padding: 0;
            color: #333;
        }

        h2 {
            text-align: center;
            margin-top: 30px;
            font-size: 28px;
            color: #d1246b;
        }

        .dropdown-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .dropdown {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .table-container {
            margin: 0 auto;
            width: 90%;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            padding: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            padding: 15px;
            text-align: left;
        }

        th {
            background-color: #f9f9f9;
            color: #333;
            border-bottom: 2px solid #eee;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        tr:nth-child(even) {
            background-color: #fafafa;
        }

        input[type="checkbox"] {
            transform: scale(1.2);
        }

        .submit-btn, .cart-btn, .clear-btn {
            padding: 12px 25px;
            background-color: #d1246b;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            margin: 5px;
            transition: background-color 0.3s ease;
        }

        .cart-btn {
            background-color: #007bff;
        }

        .clear-btn {
            background-color: #f44336;
        }

        .submit-btn:hover, .cart-btn:hover, .clear-btn:hover {
            opacity: 0.85;
        }

        .buttons-container {
            text-align: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .dropdown-container {
                flex-direction: column;
                align-items: center;
            }

            .table-container {
                width: 100%;
                padding: 15px;
            }

            h2 {
                font-size: 24px;
            }

            .submit-btn, .cart-btn, .clear-btn {
                font-size: 14px;
                padding: 10px 20px;
            }
        }
    </style>

    <!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

        <!--font-family-->
		<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&amp;subset=devanagari,latin-ext" rel="stylesheet">
        
        <!-- title of site -->
        <title>eWaraqa</title>

        <!-- For favicon png -->
		<link rel="shortcut icon" type="image/icon" href="assets/logo/favicon.png"/>
       
        <!--font-awesome.min.css-->
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">

		<!--flat icon css-->
		<link rel="stylesheet" href="assets/css/flaticon.css">

		<!--animate.css-->
        <link rel="stylesheet" href="assets/css/animate.css">

        <!--owl.carousel.css-->
        <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
		<link rel="stylesheet" href="assets/css/owl.theme.default.min.css">
		
        <!--bootstrap.min.css-->
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">
		
		<!-- bootsnav -->
		<link rel="stylesheet" href="assets/css/bootsnav.css" >	
        
        <!--style.css-->
        <link rel="stylesheet" href="assets/css/style.css">
        
        <!--responsive.css-->
        <link rel="stylesheet" href="assets/css/responsive.css">
        
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		
        <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
</head>
<body>
    <header>
      
     	<!-- top-area Start -->
		<header class="top-area">
			<div class="header-area">
				<!-- Start Navigation -->
			    <nav class="navbar navbar-default bootsnav navbar-fixed dark no-background">

			        <div class="container">

			            <!-- Start Header Navigation -->
			            <div class="navbar-header">
			                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
			                    <i class="fa fa-bars"></i>
			                </button>
			                <a href="index.html"> <img src="assets/logo/logo.png" alt="eWaraqa Logo" style="margin-top: 25px;"/>
      													</a>
			            </div><!--/.navbar-header-->
			            <!-- End Header Navigation -->

			            
			            
			                <!-- Collect the nav links, forms, and other content for toggling -->
			            <div class="collapse navbar-collapse menu-ui-design" id="navbar-menu">
                    <ul class="nav navbar-nav navbar-right" data-in="fadeInDown" data-out="fadeOutUp">
                    <li class=" smooth-menu active"></li>
                    <li class="smooth-menu"><a href="index.html#skills">Higher Education</a></li>
                    <li class=" smooth-menu"><a href="index.html#education">Services</a></li>
                    <li class="smooth-menu"><a href="index.html#profiles">Clients</a></li>
                    <li class="smooth-menu"><a href="index.html#experience">Events</a></li>
                    <li class="smooth-menu"><a href="index.html#contact">Contact Us</a></li>
                        <!--<li class="smooth-menu"><a href="#portfolio">portfolio</a></li>-->
                        <!--<li class="smooth-menu"><a href="#clients">clients</a></li>-->
                   <li ><a href="packages.html">Collections</a>
            </li>
                    </ul><!--/.nav -->
			            </div><!-- /.navbar-collapse -->
			        </div><!--/.container-->
			    </nav><!--/nav-->
			    <!-- End Navigation -->
			</div><!--/.header-area-->

		    

             <div class="container">
                <div class="section-heading text-center">
             <h2 style="margin-top: 100px;">Journals </h2>
             <span id="packageTitle"></span>
             
                
                
                  


                   <!-- Package Filter -->
        <div class="dropdown-container">
            <div class="dropdown">
                 <label for="package">Filter by Package:</label>
                <select id="package" onchange="filterSubjectsByPackage()">
                <option value="">-- Select Package --</option>
                </select>
            </div>

             <!-- Subject Filter -->
             <div class="dropdown">
            <label for="subject">Filter by Subject:</label>
            <select id="subject" onchange="filterJournals()">
                <option value="">-- Select Subject --</option>
            </select>
              </div>
            </div>
        

              <!-- Table to show journals -->
             <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>
                            <input
                                type="checkbox"
                                id="selectAll"
                                onclick="toggleAllSelection()"
                            />
                            Select All
                        </th>
                        <th>Journal</th>
                    </tr>
                </thead>
                <tbody id="resultTable"></tbody>
            </table>
             </div>

              <!-- Add to cart button -->
              <button class="submit-btn" onclick="addToCart()">Add to Cart</button>

              <!-- Cart button -->
              <button class="cart-btn" onclick="viewCart()">View Cart</button>

              <!-- clear cart button -->
             <button class="submit-btn" onclick="clearCart()">Clear Cart</button>

             <div id="cartPage" style="display: none">
            <h3>Selected Journals in Cart</h3>
            <ul id="cartItems"></ul>
            <h3>Selected Journals in Cart</h3>
 
            <button class="submit-btn" onclick="deleteSelectedItems()">Delete Selected Items</button> <!-- New delete button -->
            <button class="submit-btn" onclick="requestQuotation()">Request Quotation</button>

           
             </div>
         </div>

    <script>
  function fetchCSV(url) {
    return fetch(url)
      .then(response => response.text())
      .then(text => {
        return text.split('\n').map(row => row.split(','));
      });
  }
  

  function initializeFilters() {
    fetchCSV('journals.csv').then(data => {
        const packageSelect = document.getElementById('package');
        const headers = data[0];
        const rows = data.slice(1);

        // Use a Set to ensure unique packages
        const uniquePackages = new Set();

        rows.forEach(row => {
            if (row.length === headers.length) {
                const [packageName] = row;
                
                // Add to Set if not a duplicate
                if (!uniquePackages.has(packageName)) {
                    uniquePackages.add(packageName);
                    
                    const option = document.createElement('option');
                    option.value = packageName;
                    option.textContent = packageName;
                    packageSelect.appendChild(option);
                }
            }
        });
    });
}

function filterSubjectsByPackage() {
    const selectedPackage = document.getElementById('package').value.trim();
    const subjectSelect = document.getElementById('subject');
    subjectSelect.innerHTML = '<option value="">-- Select Subject --</option>'; // Clear existing options

    if (selectedPackage === "") {
        return; // Exit if no package is selected
    }

    fetchCSV('journals.csv').then(data => {
        const headers = data[0];
        const rows = data.slice(1);

        // Use a Set to ensure unique subjects for the selected package
        const uniqueSubjects = new Set();

        rows.forEach(row => {
            if (row.length === headers.length) {
                const [packageName, subjectName] = row;
                
                // Only add subjects that match the selected package
                if (packageName.trim() === selectedPackage && !uniqueSubjects.has(subjectName)) {
                    uniqueSubjects.add(subjectName);
                    
                    const option = document.createElement('option');
                    option.value = subjectName;
                    option.textContent = subjectName;
                    subjectSelect.appendChild(option);
                }
            }
        });
        
    });
    
}


function initializeTable() {
    
  const urlParams = new URLSearchParams(window.location.search);
  const selectedPackage = urlParams.get('package');
  document.getElementById('packageTitle').textContent = selectedPackage;

  fetchCSV('journals.csv').then(data => {
    const tableBody = document.getElementById('resultTable');
    tableBody.innerHTML = ""; // Clear existing rows

    const headers = data[0];
    const rows = data.slice(1);

    rows.forEach(row => {
      if (row.length === headers.length) {
        const [packageName, subjectName, journalName] = row;

        if (packageName === selectedPackage) {
          const rowHTML = `
              <tr>
                  <td><input type="checkbox" class="select-row" data-journal="${journalName}"></td>
                  <td>${journalName}</td>
              </tr>
          `;
          tableBody.innerHTML += rowHTML;
        }
      }
    });
  });
}


function filterJournals() {
    const selectedSubject = document.getElementById('subject').value.trim().toLowerCase();
    const selectedPackage = document.getElementById('package').value.trim().toLowerCase();
    const tableBody = document.getElementById('resultTable');
    tableBody.innerHTML = ""; // Clear existing rows

    fetchCSV('journals.csv').then(data => {
        const headers = data[0];
        const rows = data.slice(1);

        rows.forEach(row => {
            if (row.length === headers.length) {
                const [packageName, subjectName, journalName] = row.map(item => item.trim().toLowerCase());

                // Ensure the filter works for both subject and package
                if ((selectedPackage === "" || packageName === selectedPackage) && 
                    (selectedSubject === "" || subjectName === selectedSubject)) {
                    const rowHTML = `
                        <tr>
                            <td><input type="checkbox" class="select-row" data-journal="${journalName}"></td>
                            <td>${journalName}</td>
                        </tr>
                    `;
                    tableBody.innerHTML += rowHTML;
                }
            }
        });
    });
}





  function toggleAllSelection() {
    const selectAll = document.getElementById('selectAll').checked;
    const checkboxes = document.querySelectorAll('.select-row');
    checkboxes.forEach(checkbox => (checkbox.checked = selectAll));
  }

  function addToCart() {
    const selectedRows = document.querySelectorAll('.select-row:checked');
    const selectedPackage = document.getElementById('package').value.trim();
    const selectedSubject = document.getElementById('subject').value.trim();

    selectedRows.forEach(row => {
        const journal = row.getAttribute('data-journal');

        // Check if the journal already exists in the cart
        const exists = cart.some(item => item.journal === journal && item.package === selectedPackage && item.subject === selectedSubject);

        if (!exists) {
            // Add to cart with package and subject details
            cart.push({
                journal: journal,
                package: selectedPackage,
                subject: selectedSubject
            });
        }
    });

    alert('Journals added to cart!');
}

function clearCart() {
    const cartItems = document.getElementById('cartItems');
    cartItems.innerHTML = ""; // Clear existing cart items
    document.getElementById('cartPage').style.display = 'none'; // Hide cart page
    document.getElementById('selectAll').checked = false; // Uncheck the "Select All" checkbox
    
    const checkboxes = document.querySelectorAll('#resultTable input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
        checkbox.checked = false; // Uncheck all journal checkboxes
    });
    
    // Clear the cart array
    cart = [];
    
    alert('Cart cleared!');
}


function deleteFromCart(index) {
    // Remove the item from the cart based on the index
    cart.splice(index, 1);

    // Re-render the cart view after deleting the item
    viewCart();
    
    // Optional: alert the user
    alert('Item removed from the cart');
}

function deleteSelectedItems() {
    // Get all checked checkboxes
    const checkboxes = document.querySelectorAll('.cart-checkbox:checked');
    
    // Create an array to hold the indices of items to delete
    const indicesToDelete = Array.from(checkboxes).map(checkbox => parseInt(checkbox.getAttribute('data-index')));

    // Sort indices in descending order to avoid shifting issues when deleting
    indicesToDelete.sort((a, b) => b - a);

    // Remove the selected items from the cart array
    indicesToDelete.forEach(index => cart.splice(index, 1));

    // Re-render the cart view after deleting the selected items
    viewCart();
    
    // Optional: alert the user
    alert('Selected items removed from the cart');
}


function viewCart() {
    const cartPage = document.getElementById('cartPage');
    const cartItems = document.getElementById('cartItems');

    cartPage.style.display = 'block'; // Show cart page
    cartItems.innerHTML = ''; // Clear existing cart items

    if (cart.length === 0) {
        cartItems.innerHTML = '<li>No items in cart</li>';
    } else {
        cart.forEach((item, index) => {
            const listItem = `
                <li>
                    <input type="checkbox" class="cart-checkbox" data-index="${index}">
                    <strong>Journal:</strong> ${item.journal} <br> 
                    <strong>Package:</strong> ${item.package} <br> 
                    <strong>Subject:</strong> ${item.subject}
                </li>`;
            cartItems.innerHTML += listItem;
        });
    }
}




  function requestQuotation() {
    if (cart.length === 0) {
        alert('Your cart is empty.');
        return;
    }

    let cartDetails = 'Selected Journals for Quotation:\n\n';
    cart.forEach(item => {
        cartDetails += `Journal: ${item.journal}\nPackage: ${item.package}\nSubject: ${item.subject}\n\n`;
    });

    window.location.href =
        'mailto:hello@ewaraqa.com?subject=Request for Quotation&body=' +
        encodeURIComponent(cartDetails);
}


  let cart = [];

  window.onload = function () {
    initializeFilters(); // Initialize both package and subject filters
    initializeTable();    // Initialize the table with default values
};

</script>


        

</body>
</html>
